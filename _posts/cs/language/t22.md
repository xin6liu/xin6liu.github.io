# 线程

为什么在进程里派生多个线程？
第一个是应用的需要：（一个程序同时多个任务）
第二个是开销的考虑 
第三个呢是从性能的角度来看


eg1: word
键盘输入，排版，定时保存
eg2: web浏览器
如果它到磁盘上去搜寻网页，它就不能再去接收客户端的请求


**进程**的两个基本属性
资源的拥有者 （进程）
CPU调度单位 （线程继承）

线程的属性：
这些属性呢，属于线程自己，所以不同的线程呢，实际上有不同的值。 
1. 首先要有一个唯一的标示，ID， 所以同一个进程的不同线程你要区分。 
2. 那么线程是上 CPU 的，所以它有状态。 它也有状态的转换，也需要提供一些针对线程的操作。 
3. 在线程不运行的时候，要保存 上下文环境，因此呢要有一些相关的寄存器， 要保存在线程的相对的数据结构里头。 
4. 线程在执行过程中，需要自己的栈，有自己的栈 指针。 那么这些内容，是不同的线程是不一样的信息。 
5. 但是同一个进程的不同线程呢，它们是共享所在进程地址空间的 内容和这个进程所拥有的资源的，所以这是非常重要的，也就是 线程之间的通信，或者其他的一些操 作带来了便利的地方，它们是共享同一个进程的 地址空间和有关的资源。 同一进程的不同线程，共享地址空间和资源。
6. 那么线程当然也可以创建、 撤消另一个线程。 因为什么呢？因为我们一开始，当创建 进程以后，实际上是只有一个线程，我们称之为一个主线程。 然后之后由它再创建其他的线程，所以程序开始 的时候呢，我们可以看成是一个单线程的进程在运行。



## 线程机制的实现
三种方式：
1. 用户级线程 （内核只操作进程）
2. 核心级线程 （内核里既有进程表，又有线程表）
3. 混合方式 （在用户空间创建，在内核调度）



